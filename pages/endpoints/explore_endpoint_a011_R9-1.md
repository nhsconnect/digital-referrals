---
title: "A011: Create Referral"
keywords: endpoint, catalogue, create referral, shortlist
sidebar: overview_sidebar
toc: false
permalink: explore_endpoint_a011_R9-1.html
summary: false
---

##### Status: ![Beta](images/icons/api_beta.png)

### API URL

Base URL (Dev3): https://api.dev3.ers.ncrs.nhs.uk/ers-api/

| Method | URL | Authentication |
| -------------| --- | ---------------- |
| POST | STU3/v1/ReferralRequest/$ers.createReferral | Session Token [(Details)](develop_business_flow_bf001.html) |

### Description
As a Referring Clinician (/Administrator)  
I want to create a referral for my patient with a shortlist of services  
So that I can progress the care of my patient while leaving them the freedom to choose the service that best suits them.  

### Prerequisite Conditions
- The shortlisted service must be the result of a previously run patient service search using [A010: Patient Service Search](explore_endpoint_a010.html).
- The shortlist must not contain any Referral Assessment Services (RAS), referrals to these services should be created using endpoint [A021: Create Referral And Send For Triage](explore_endpoint_a021.html).

### Request Operation
#### Request Header

| Field Name | Value |
| ---- | ---- |
| XAPI_ASID | The "Accredited System ID" issued to the third party |
| HTTP_X_SESSION_KEY | The session key generated by the Create Session endpoint (A001)  |

#### Request Body
The Operation Definition for this endpoint is available on the FHIR server:  [eRS-CreateReferral-Operation-1](https://fhir.nhs.uk/STU3/OperationDefinition/eRS-CreateReferral-Operation-1)

| Parameter Name            | Cardinality | Type            | Notes |
| ------------------------- | --------- | --------------- | ----- |
| patient                   | 1..1        | Identifier |The master NHS Number for the patient  |
| referringClinician        | 0..1        | Identifier      |    |
| shortlist                   | 1..1        | Resource      |The structure definition of this resource is:  [eRS-Shortlist-List-1](https://fhir.nhs.uk/STU3/StructureDefinition/eRS-Shortlist-List-1). Please note that in turn this Resource needs to have a contained reference to an [eRS-ServiceSearchCriteria-Parameters-1](https://fhir.nhs.uk/STU3/StructureDefinition/eRS-ServiceSearchCriteria-Parameters-1)  |
| firstReminderLetterFollowUpDays | 1..1 | UnsignedInt | |
| intentionToAddReferralLetter | 1..1| Coding | If shortlisting a service flagged as requiring a referral letter by the result of a [Patient Service Search](explore_endpoint_a010.html) (and only in this case) then the value of this field must be NEED_TO_ADD_LATER |  

#### Removed Parameters  

| Removed Parameter Name   | Notes |
| ------------------------ | ----------- |
| unaccreditedComment      | This parameter was removed in e-RS Release 9.1 |
| contentSensitive         | This parameter was removed in e-RS Release 9.1 |


### Response

#### Success
HTTP Status code `201 (Created)` is returned. The response body contains the just created [eRS-ReferralRequest-1](https://fhir.nhs.uk/STU3/StructureDefinition/eRS-ReferralRequest-1).

#### Failure
If an error occurs, the relating [HTTP status code](explore_error_messages.html) will be returned in the header.
Where status code 422 (Unprocessable Entity) is returned then an [eRS-OperationOutcome-1](https://fhir.nhs.uk/STU3/StructureDefinition/eRS-OperationOutcome-1) will be included in the body, as detailed below.  

| issue.details.code  | Description |
| ------------------- | ----------- |
| FIELD_NOT_PERMITTED | A referring clinician is provided when the logged in user is not an RCA; or: one of the following occurs: the distance limit is specified when the postcode is not provided, the IWT limit is specified when the priority is TWO_WEEK_WAIT or the clinic type is specified when the specialty is not provided.|
| INAPPROPRIATE_VALUE | The value of _commissioning provisioning_ is ALL_SERVICES (this value is not supported), or: the _intention to add a referral letter_ is set to NOT_INTENDING_TO_ADD when one or more of the shortlisted services has the _referral letter required_ set to true, or the proposed shortlist contains one or more services that do not support the ‘appointment request flow’ |
| INVALID VALUE | The input provided does not conform with the expected data types and format specifically documented on the FHIR OperationDefinition or on the related FHIR profiles |
| MISSING_VALUE | One of the parameters described as mandatory on the FHIR OperationDefinition or on the related FHIR profiles has not been supplied
| NO_REG_GP_PRACTICE | The patient provided was found *not* to have a registered GP practice. The patient is not eligible to be referred via e-RS while this problem persists |
| ORGANISATION_IS_CLOSED | The organisation identifier supplied corresponds to an organisation that is closed |
| ORGANISATION_NOT_APPROPRIATE | The organisation identifier supplied corresponds to an organisation of a type other than 'Service location' and 'Service providing organisation' |
| PATIENT_ERROR | There was a problem with the patient's record in PDS. The patient is not eligible to be referred via e-RS while this problem persists|
| REFERENCE_NOT_FOUND | An entity referenced (e.g. the patient, the postcode, the organisation or a clinician) is not found |
| REFERENCED_USER_IS_NOT_ACTIVE | The SDS user provided as the _referring clinician_ or the _named clinician_ is found to be *not* active in SDS |
| REFERENCED_USER_IS_NOT_RC | The SDS user provided as the _referring clinician_ does not actually have the Referring Clinician business function in e-RS |
| REFERENCED_USER_IS_NOT_SPC | The SDS user provided as the _named clinician_ does not actually have the Service Provider Clinician business function in e-RS |
| REFERENCED_USER_NOT_IN_ORG | The  _referring clinician_ provided does not belong to the same organisation as the logged in user |
| SHORTLISTED_SERVICE_NOT_IN_RESULTS | The service selected for the shortlist submitted does not satisfy the search criteria provided |
| VALUE_IS_REQUIRED | A referring clinician is not provided when the logged in user is an RCA; or: one of the following three is not provided: the pair specialty + clinic type, the clinical term¬ or the named clinician.|

#### Examples:
##### Note: These examples contain test data, these should be replaced with appropriate values for your implementation.  

<details><summary>View example request</summary>
<br>
  <pre>
  {
    "resourceType": "Parameters",
    "meta": {
      "profile": [
        "https://fhir.nhs.uk/STU3/StructureDefinition/eRS-CreateReferral-Parameters-1"
      ]
    },
    "parameter": [
      {
        "name": "patient",
        "valueIdentifier": {
          "system": "http://fhir.nhs.net/Id/nhs-number",
          "value": "1000000001"
        }
      },
      {
        "name": "intentionToAddReferralLetter",
        "valueCoding": {
          "system": "https://fhir.nhs.uk/STU3/CodeSystem/eRS-ReferralLetterIntention-1",
          "code": "NEED_TO_ADD_LATER"
        }
      },
      {
        "name": "firstReminderLetterFollowUpDays",
        "valueUnsignedInt": 0
      },
      {
        "name": "shortlist",
        "resource": {
          "meta": {
            "profile": [
              "https://fhir.nhs.uk/STU3/StructureDefinition/eRS-Shortlist-List-1"
            ]
          },
          "resourceType": "List",
          "status": "current",
          "mode": "snapshot",
          "contained": [
            {
              "resourceType": "Parameters",
              "meta": {
                "profile": [
                  "https://fhir.nhs.uk/STU3/StructureDefinition/eRS-ServiceSearchCriteria-Parameters-1"
                ]
              },
              "id": "ServiceSearchCriteria-1",
              "parameter": [
                {
                  "name": "priority",
                  "valueCoding": {
                    "system": "https://fhir.nhs.uk/STU3/CodeSystem/eRS-Priority-1",
                    "code": "ROUTINE"
                  }
                },
                {
                  "name": "specialty",
                  "valueCoding": {
                    "system": "https://fhir.nhs.uk/STU3/CodeSystem/eRS-Specialty-1",
                    "code": "2WW"
                  }
                },
                {
                  "name": "clinicType",
                  "valueCoding": {
                    "system": "https://fhir.nhs.uk/STU3/CodeSystem/eRS-ClinicType-1",
                    "code": "2WW_BONE"
                  }
                },
                {
                  "name": "commissioningProvisioning",
                  "valueCoding": {
                    "system": "https://fhir.nhs.uk/STU3/CodeSystem/eRS-CommissioningProvisioning-1",
                    "code": "ALL_AVAILABLE_FOR_BOOKING"
                  }
                },
                {
                  "name": "ageAndGenderAppropriate",
                  "valueBoolean": false
                }
              ]
            }
          ],
          "entry": [
            {
              "item": {
                "identifier": {
                  "system": "http://fhir.nhs.net/Id/ers-service",
                  "value": "50"
                }
              }
            },
            {
              "item": {
                "identifier": {
                  "system": "http://fhir.nhs.net/Id/ers-service",
                  "value": "57"
                }
              }
            }
          ],
          "extension": [
            {
              "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-eRS-Shortlist-SearchCriteria-1",
              "valueReference": {
                "reference": "#ServiceSearchCriteria-1"
              }
            }
          ]
        }
      }
    ]
  }
  </pre>
</details>
[Download request example](downloads/json/A011 Request Sample 1.json)  

<details><summary>View example response</summary>
<br>
  <pre>
  {
    "id": "000000070023",
    "meta": {
      "versionId": "3",
      "profile": [
        "https://fhir.nhs.uk/STU3/StructureDefinition/eRS-ReferralRequest-1"
      ]
    },
    "resourceType": "ReferralRequest",
    "extension": [
      {
        "url": "https://fhir.nhs.uk/STU3/StructureDefinition/Extension-eRS-ReferralPriority-1",
        "valueCodeableConcept": {
          "coding": [
            {
              "system": "https://fhir.nhs.uk/STU3/CodeSystem/eRS-Priority-1",
              "code": "ROUTINE",
              "display": "Routine"
            }
          ]
        }
      }
    ],
    "status": "active",
    "subject": {
      "identifier": {
        "system": "http://fhir.nhs.net/Id/nhs-number",
        "value": "1000000001"
      }
    },
    "supportingInfo": [],
    "intent": "plan"
  }
  </pre>
</details
[Download response example](downloads/json/A011 Response Sample 1.json)  

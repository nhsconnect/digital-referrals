---
title: "A015: Retrieve Appointment Slots"
keywords: endpoint, catalogue
sidebar: overview_sidebar
toc: false
permalink: explore_endpoint_a015.html
summary: false
---

#### Status: ![Live](images/icons/api_live.png)

## Description
This API makes available e-RS functionality which will allow the retrieval of appointment slots for a single service.  By retrieving appointment slots, subsequent APIs are supported in terms of appointment booking or deferring to a provider.
The implementation to expose slots uses the “NHS Scheduling” FHIR model and is standard across all NHS systems.  Further information on the scheduling resource can be found [here](https://developer.nhs.uk/apis/nhsscheduling-1.0.6-alpha/resources_overview.html).


## Resource URL

Base URL (Dev1): https://api.dev1.ers.ncrs.nhs.uk/ers-api/  

| Method       | URL | Authentication |
| -------------| --- | ---------------- |
| GET          | STU3/v1/Slot | Session Token [(Details)](develop_business_flow_bf001.html) |


## Structure Definition
- [eRS-Appointment-1](https://fhir.nhs.uk/STU3/StructureDefinition/eRS-Appointment-1)  

## Prerequisite Conditions

-	The user is authenticated with an effective business function of Referring Clinician or Referring Clinician Admin;
-	The user has created an appointment request via A011: Create Referral


# INPUT

## Request Operation: Header

| Field Name | Value |
| ---------- | ----- |
| XAPI_ASID | The "Accredited System ID" issued to the third party |
| HTTP_X_SESSION_KEY | The session key generated by the [Authentication and Authorisation APIs](/develop_business_flow_bf001.html)  |
| X-ERS-XAPI-COMM-RULE-ORG | The ODS code of the NHS organisation which has commissioned the service. This value must be supplied if searching for appointment slots for a service so that commissioned rules can be considered as part of the search parameters. This ensures that slots are returned within the commissioning contract period, available to be booked.

If no code is supplied and commissioning rules apply, appointment slots may still be returned but subsequent steps to book will fail.
The rule context organisation is included in the returned FHIR ReferralRequest via A005: Retrieve Referral Request. |

## Request Operation: Parameters

| Name              | FHIR Parameter                   | Cardinality | Type   | Description                        |
| ----------------- | ---------------------------------| ----------- | ------ | ---------------------------------- |
| serviceID         | schedule.actor:HealthcareService | 0..1        | Number | A single service ID is required to indicate the service for which appointment slots are required
| namedClinician    | schedule.actor:Practitioner      | 0..0        | Number | Slots in e-RS may be allocated to a clinician and is set in the service provider's PAS. If a named clinician is supplied (by the UUID), the appointment slots returned are constrained to slots for which this clinician is allocated to the appointment slot. The clinician must be a named clinician for the selected service. |
| priority          | appointmentType                  | 0..1        | Coding | Optional priority change (eRS-Priority-1) |
| status            | status                           | 0..1        | String | The status of the appointment slots required must be supplied. This must indicate that "free" slots are required|
| pageSize          | _count                           | 0..1        | Number | The pageSize is the maximum number of results (i.e. slots) that should be returned by this call. This value must be in the range of 1-100. 100 is the maximum slots available per API call. <br>Note: Page contents cannot be guaranteed to be contiguous with no gaps or duplicates since the availability of slots may change between calls to the API. |
| pageNumber        | page                             | 0..1        | Number | The pageNumber is the number of pages required to be returned, starting at 1. |


### Example URI
```https://api.dev1.ers.ncrs.nhs.uk/ers-api/STU3/v1/Slot/?schedule.actor:HealthcareService=700345&schedule.actor:Practitioner=021600556514&appointmentType=ROUTINE&_count=20&page=1&status=free&_include=Slot:schedule
```

### Example Request Header
Not required.


### Example Request Body
Not required.

# OUTPUT
## Response: Success
If successful, when at least one slot has been found, a FHIR Bundle resource is returned.

The API will supply slots from the earliest available appointment date/time up to a configurable value. In the (valid) scenario where no slots are found, an empty bundle will be returned, at which point a user can select to defer to the provider via [A017: Defer Booking to Provider](explore_endpoint_a017.html).

### Example Response Header
```http
```

### Example Response Body
##### Note: These examples may contain environment specific URLs and test data, these should be replaced with appropriate values for your implementation.  

- [(Missing example file)](downloads/json/[filename])  

## Response: Failure
If an error occurs, the relating HTTP status code will be returned in the header.  

Where status code 422 (Unprocessable Entity) is returned then an [eRS-OperationOutcome-1](https://fhir.nhs.uk/STU3/StructureDefinition/eRS-OperationOutcome-1) will be included in the body, as detailed below:

| OutcomeKey      | Description                                               | Suggested Diagnostic                                  |
| --------------- | --------------------------------------------------------- | ----------------------------------------------------- |
| NO_SUCH_SERVICE | No service exists or has ever existed for this service ID | Check the service ID via A010: Patient Service Search |
| SERVICE_UNAVAILABLE | The service is no longer available in the directory of services (DoS) within e-RS, "Service no longer available" message is returned | The service must be active, published and within its effective date range. Check the service ID via A010: Patient Service Search |
| INVALID_STATE | The selected service does not support an appointment request, "Unbookable service" message is returned | The service must support an appointment request, i.e. not be a triage service |
| INVALID_STATE | The selected service does not support an appointment request, "Service is not directly bookable" message is returned | The service must be bookable, i.e. a Directly Bookable Service (DBS) |
| INVALID_CODE | The slot status parameter value is not valid, "Invalid status code" message is returned | Select a valid code from those listed in [valueset-slotstatus](http://hl7.org/fhir/STU3/valueset-slotstatus.html) |
| INVALID_VALUE | The slot status parameter is not ‘free’, "Requested status is not supported" message is returned | The slot status parameter must be ‘free’ |
| INVALID_VALUE | The pageSize (FHIR '_count') parameter is not valid, "Invalid page size" message is returned  | The pageSize parameter cannot be less than 1 or higher than 100 |
| INVALID_VALUE | The pageNumber (FHIR 'page') parameter is not valid, "Invalid page number" message is returned | The pageNumber parameter must be an integer, and have a value more than 1, or higher than the last page available. If no slots match and the requested page number is 1, no error is returned. Instead, an empty bundle is returned |
| INVALID_VALUE | The named clinician (FHIR 'schedule.actor:Practitioner') parameter is not valid, "Invalid practitioner for service" message is returned | The professional user must exist, be active, and be a named clinician at the selected service |
| MISSING_PARAMETER | The Commissioning Rule Organisation parameter (via the HTTP header field) is not present, "No commissioning rule org parameter" message is returned. | The Rule Context Organisation (as the "Commissioning Rule Org") applies if the service is on the primary care menu and must be present for all cases |
| INVALID_VALUE | The Commissioning Rule Organisation parameter (via the HTTP header field) is not valid, "Commissioning Rule Organisation is not a referring organisation" message is returned | The Commissioning Rule Organisation ODS code must be recognised as an active referring organisation. e-RS organisation types such as referring organisation are mapped from SDS organisation types |
